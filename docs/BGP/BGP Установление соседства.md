
* Использует порт TCP-179
	- Инициализация установления сессии на 179 порт 
	- Прослушивание входящих соединений на 179 порт 
	- В случае коллизии, устройство с большим  router-id становится клиентом 

#### Определение коллизий 

- Коллизия возникает когда оба BGP соседа пытаются установить TCP сессию
- Одна из них должна быть разорвана
- В качестве арбитра выступает router-id 
	-  Остается соединение инициированное соседом с более высоким router-id 
- Закрытие сессии происходит через отправку NOTIFICATION c кодом ошибки Cease 

#### BGP FSM

![BGP FSM](https://www.pvsm.ru/images/seti-dlya-samyh-malenkih-chast-vosmaya-BGP-i-IP-SLA-31.png)

##### IDLE 
- BGP отбрасывает любые входящие запросы 
- Ресурсы под процесс не выделены 
- Частый кейс - нет маршрута 

##### CONNECT
- BGP  только слушает TCP-179 
- Кратковременное 

##### ACTIVE 
- Попытка установить исходящее соединение 
- Входящие запросы будут обработаны 

##### OPENSENT 
- Ожидает OPEN от соседа 

##### OPENCONFIRM 
- От соседа получено корректное OPEN 
- Ожидает KEEPALIVE или NOTIFICATION 

##### ESTABLISHED 



#### Типы соседства 

##### eBGP 
- Сосед из чужой AS, полное недоверие 
- TTL = 1 
- Атрибуты модифицируются отправителем 

##### iBGP 
- Сосед из своей AS, частично доверяем 
- TTL = 255 
- Атрибуты не модифицируются при отправке ()
- Чаще всего устанавливается с LoopBack интерфейсов 


> Отличаются настройками по умолчанию в работе протокола BGP

